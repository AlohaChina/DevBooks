# MySQL最新面试题及答案附答案汇总

### 其实，博主还整理了，更多大厂面试题，直接下载吧

### 下载链接：[高清172份，累计 7701 页大厂面试题  PDF](https://www.souyunku.com/?p=67)

### 一键直达：[https://www.souyunku.com/?p=67](https://www.souyunku.com/?p=67)



### 1、事务是如何通过日志来实现的

因为事务在修改页时，要先记 undo，在记 undo 之前要记 undo 的 redo， 然后修改数据页，再记数据页修改的 redo。 Redo（里面包括 undo 的修改） 一定要比数据页先持久化到磁盘。

当事务需要回滚时，因为有 undo，可以把数据页回滚到前镜像的 状态，崩溃恢复时，如果 redo log 中事务没有对应的 commit 记录，那么需要用 undo把该事务的修改回滚到事务开始之前。

如果有 commit 记录，就用 redo 前滚到该事务完成时并提交掉。


### 2、MySQL数据库cpu飙升的话，要怎么处理呢？

**「排查过程：」**

使用top 命令观察，确定是MySQLd导致还是其他原因。

如果是MySQLd导致的，show processlist，查看session情况，确定是不是有消耗资源的sql在运行。

找出消耗高的 sql，看看执行计划是否准确， 索引是否缺失，数据量是否太大。

**「处理：」**

kill 掉这些线程(同时观察 cpu 使用率是否下降)，

进行相应的调整(比如说加索引、改 sql、改内存参数)

重新跑这些 SQL。

**「其他情况：」**

也有可能是每个 sql 消耗资源并不多，但是突然之间，有大量的 session 连进来导致 cpu 飙升，这种情况就需要跟应用一起来分析为何连接数会激增，再做出相应的调整，比如说限制连接数等


### 3、MySQL中有哪几种锁？

**1、** 表级锁：开销小，加锁快；不会出现死锁；锁定粒度大，发生锁冲突的概率最高，并发度最低。

**2、** 行级锁：开销大，加锁慢；会出现死锁；锁定粒度最小，发生锁冲突的概率最低，并发度也最高。

**3、** 页面锁：开销和加锁时间界于表锁和行锁之间；会出现死锁；锁定粒度界于表锁和行锁之间，并发度一般。


### 4、什么是游标？

游标提供了一种对从表中检索出的数据进行操作的灵活手段，就本质而言，游标实际上是一种能从包括多条数据记录的结果集中每次提取一条记录的机制。


### 5、说说分库与分表的设计

**分库分表方案，分库分表中间件，分库分表可能遇到的问题**

**分库分表方案:**

**1、** 水平分库：以字段为依据，按照一定策略（hash、range等），将一个库中的数据拆分到多个库中。

**2、** 水平分表：以字段为依据，按照一定策略（hash、range等），将一个表中的数据拆分到多个表中。

**3、** 垂直分库：以表为依据，按照业务归属不同，将不同的表拆分到不同的库中。

**4、** 垂直分表：以字段为依据，按照字段的活跃性，将表中字段拆到不同的表（主表和扩展表）中。

**常用的分库分表中间件：**

**1、** sharding-jdbc（当当）

**2、** Mycat

**3、** TDDL（淘宝）

**4、** Oceanus(58同城数据库中间件)

**5、** vitess（谷歌开发的数据库中间件）

**6、** Atlas(Qihoo 360)

**分库分表可能遇到的问题**

**1、** 事务问题：需要用分布式事务啦

**2、** 跨节点Join的问题：解决这一问题可以分两次查询实现

**3、** 跨节点的count,order by,group by以及聚合函数问题：分别在各个节点上得到结果后在应用程序端进行合并。

**4、** 数据迁移，容量规划，扩容等问题

**5、** ID问题：数据库被切分后，不能再依赖数据库自身的主键生成机制啦，最简单可以考虑UUID

**6、** 跨分片的排序分页问题（后台加大pagesize处理？）


### 6、主键、外键和索引的区别？

主键、外键和索引的区别

**定义：**

**1、** 主键–唯一标识一条记录，不能有重复的，不允许为空

**2、** 外键–表的外键是另一表的主键, 外键可以有重复的, 可以是空值

**3、** 索引–该字段没有重复值，但可以有一个空值

**作用：**

**1、** 主键–用来保证数据完整性

**2、** 外键–用来和其他表建立联系用的

**3、** 索引–是提高查询排序的速度

**个数：**

**1、** 主键–主键只能有一个

**2、** 外键–一个表可以有多个外键

**3、** 索引–一个表可以有多个唯一索引


### 7、数据表损坏的修复方式有哪些？

**使用 myisamchk 来修复，具体步骤：**

**1、** 修复前将MySQL服务停止。

**2、** 打开命令行方式，然后进入到MySQL的/bin目录。

**3、** 执行myisamchk –recover 数据库所在路径/*.MYI

使用repair table 或者 OPTIMIZE table命令来修复，REPAIR TABLE table_name 修复表 OPTIMIZE TABLE table_name 优化表 REPAIR TABLE 用于修复被破坏的表。 OPTIMIZE TABLE 用于回收闲置的数据库空间，当表上的数据行被删除时，所占据的磁盘空间并没有立即被回收，使用了OPTIMIZE TABLE命令后这些空间将被回收，并且对磁盘上的数据行进行重排（注意：是磁盘上，而非数据库）`




### 8、优化关联查询

**1、** 确定ON或者USING子句中是否有索引。

**2、** 确保GROUP BY和ORDER BY只有一个表中的列，这样MySQL才有可能使用索引。


### 9、在高并发情况下，如何做到安全的修改同一行数据？

要安全的修改同一行数据，就要保证一个线程在修改时其它线程无法更新这行记录。一般有悲观锁和乐观锁两种方案~

**使用悲观锁**

悲观锁思想就是，当前线程要进来修改数据时，别的线程都得拒之门外~

比如，可以使用select…for update ~

```
select * from User where name=‘jay’ for update
```

以上这条sql语句会锁定了User表中所有符合检索条件（name=‘jay’）的记录。本次事务提交之前，别的线程都无法修改这些记录。

**使用乐观锁**

乐观锁思想就是，有线程过来，先放过去修改，如果看到别的线程没修改过，就可以修改成功，如果别的线程修改过，就修改失败或者重试。实现方式：乐观锁一般会使用版本号机制或CAS算法实现。


### 10、MYSQL支持事务吗？

在缺省模式下，MYSQL是autocommit模式的，所有的数据库更新操作都会即时提交，所以在缺省情况下，MySQL是不支持事务的。

但是如果你的MYSQL表类型是使用InnoDB Tables 或 BDB tables的话，你的MYSQL就可以使用事务处理,使用SET

AUTOCOMMIT=0就可以使MYSQL允许在非autocommit模式，在非autocommit模式下，你必须使用COMMIT来提交你的更改，或者用ROLLBACK来回滚你的更改。


### 11、读写分离有哪些解决方案？
### 12、什么是索引？
### 13、慢查询日志
### 14、大表数据查询，怎么优化
### 15、MySQL的复制原理以及流程
### 16、为什么要使用数据库
### 17、MySQL存储引擎MyISAM与InnoDB区别
### 18、为什么要使用视图？什么是视图？
### 19、SQL的执行顺序
### 20、LIKE声明中的％和_是什么意思？
### 21、Myql中的事务回滚机制概述
### 22、按照锁的粒度分，数据库锁有哪些呢？锁机制与InnoDB锁算法
### 23、主键、外键和索引的区别？
### 24、为什么要尽量设定一个主键？
### 25、SQL语句的语法顺序：
### 26、索引的基本原理
### 27、varchar与char的区别
### 28、按照锁的粒度分数据库锁有哪些？锁机制与InnoDB锁算法
### 29、你怎么知道SQL语句性能是高还是低
### 30、什么是存储过程？有哪些优缺点？




## 全部答案，整理好了，直接下载吧

### 下载链接：[全部答案，整理好了](https://www.souyunku.com/?p=67)

### 一键直达：[https://www.souyunku.com/?p=67](https://www.souyunku.com/?p=67)


## 最新，高清PDF：172份，7701页，最新整理

[![大厂面试题](https://www.souyunku.com/wp-content/uploads/weixin/mst.png "架构师专栏")](https://www.souyunku.com/wp-content/uploads/weixin/githup-weixin.png "架构师专栏")

[![大厂面试题](https://www.souyunku.com/wp-content/uploads/weixin/githup-weixin.png "架构师专栏")](https://www.souyunku.com/wp-content/uploads/weixin/githup-weixin.png "架构师专栏")
