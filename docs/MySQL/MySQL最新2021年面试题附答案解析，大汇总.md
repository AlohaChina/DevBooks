# MySQL最新2021年面试题附答案解析，大汇总

### 其实，博主还整理了，更多大厂面试题，直接下载吧

### 下载链接：[高清172份，累计 7701 页大厂面试题  PDF](https://www.souyunku.com/?p=67)

### 一键直达：[https://www.souyunku.com/?p=67](https://www.souyunku.com/?p=67)



### 1、如何优化查询过程中的数据访问

**1、** 访问数据太多导致查询性能下降

**2、** 确定应用程序是否在检索大量超过需要的数据，可能是太多行或列

**3、** 确认MySQL服务器是否在分析大量不必要的数据行

**4、** 避免犯如下SQL语句错误

**5、** 避免查询不需要的数据。解决办法：使用limit解决

**6、** 多表关联返回全部列。解决办法：指定列名

**7、** 总是返回全部列。解决办法：避免使用SELECT *

**8、** 重复查询相同的数据。解决办法：可以缓存数据，下次直接读取缓存

**9、** 使用explain进行分析，如果发现查询需要扫描大量的数据，但只返回少数的行，可以通过如下技巧去优化：

**10、** 使用索引覆盖扫描，把所有的列都放到索引中，这样存储引擎不需要回表获取对应行就可以返回结果。

**11、** 改变数据库和表的结构，修改数据表范式

**12、** 重写SQL语句，让优化器可以以更优的方式执行查询。


### 2、视图有哪些特点？哪些使用场景？

**视图特点：**

**1、** 视图的列可以来自不同的表，是表的抽象和在逻辑意义上建立的新关系。

**2、** 视图是由基本表(实表)产生的表(虚表)。

**3、** 视图的建立和删除不影响基本表。

**4、** 对视图内容的更新(添加，删除和修改)直接影响基本表。

**5、** 当视图来自多个基本表时，不允许添加和删除数据。

**视图用途：** 简化sql查询，提高开发效率，兼容老的表结构。

**视图的常见使用场景：**

**1、** 重用SQL语句；

**2、** 简化复杂的SQL操作。

**3、** 使用表的组成部分而不是整个表；

**4、** 保护数据

**5、** 更改数据格式和表示。视图可返回与底层表的表示和格式不同的数据。


### 3、SQL 约束有哪几种？

> SQL 约束有哪几种？


**1、** NOT NULL: 用于控制字段的内容一定不能为空（NULL）。

**2、** UNIQUE: 控件字段内容不能重复，一个表允许有多个 Unique 约束。

**3、** PRIMARY KEY: 也是用于控件字段内容不能重复，但它在一个表只允许出现一个。

**4、** FOREIGN KEY: 用于预防破坏表之间连接的动作，也能防止非法数据插入外键列，因为它必须是它指向的那个表中的值之一。

**5、** CHECK: 用于控制字段的值范围。


### 4、备份计划，MySQLdump以及xtranbackup的实现原理

**备份计划**

**1、** 视库的大小来定，一般来说 100G 内的库，可以考虑使用 MySQLdump 来做，因为 MySQLdump更加轻巧灵活，备份时间选在业务低峰期，可以每天进行都进行全量备份(MySQLdump 备份出来的文件比较小，压缩之后更小)。

**2、** 100G 以上的库，可以考虑用 xtranbackup 来做，备份速度明显要比 MySQLdump 要快。一般是选择一周一个全备，其余每天进行增量备份，备份时间为业务低峰期。

**备份恢复时间**

**1、** 物理备份恢复快，逻辑备份恢复慢

**2、** 这里跟机器，尤其是硬盘的速率有关系，以下列举几个仅供参考

**3、** 20G的2分钟（MySQLdump）

**4、** 80G的30分钟(MySQLdump)

**5、** 111G的30分钟（MySQLdump)

**6、** 288G的3小时（xtra)

**7、** 3T的4小时（xtra)

**8、** 逻辑导入时间一般是备份时间的5倍以上

**备份恢复失败如何处理**

首先在恢复之前就应该做足准备工作，避免恢复的时候出错。比如说备份之后的有效性检查、权限检查、空间检查等。如果万一报错，再根据报错的提示来进行相应的调整。

**MySQLdump和xtrabackup实现原理**

**MySQLdump**

MySQLdump 属于逻辑备份。加入–single-transaction 选项可以进行一致性备份。后台进程会先设置 session 的事务隔离级别为 RR(SET SESSION TRANSACTION ISOLATION LEVELREPEATABLE READ)，之后显式开启一个事务(START TRANSACTION /*!40100 WITH CONSISTENTSNAPSHOT */)，这样就保证了该事务里读到的数据都是事务事务时候的快照。之后再把表的数据读取出来。如果加上–master-data=1 的话，在刚开始的时候还会加一个数据库的读锁(FLUSH TABLES WITH READ LOCK),等开启事务后，再记录下数据库此时 binlog 的位置(showmaster status)，马上解锁，再读取表的数据。等所有的数据都已经导完，就可以结束事务

**Xtrabackup:**

xtrabackup 属于物理备份，直接拷贝表空间文件，同时不断扫描产生的 redo 日志并保存下来。最后完成 innodb 的备份后，会做一个 flush engine logs 的操作(老版本在有 bug，在5.6 上不做此操作会丢数据)，确保所有的 redo log 都已经落盘(涉及到事务的两阶段提交

- 概念，因为 xtrabackup 并不拷贝 binlog，所以必须保证所有的 redo log 都落盘，否则可能会丢最后一组提交事务的数据)。这个时间点就是 innodb 完成备份的时间点，数据文件虽然不是一致性的，但是有这段时间的 redo 就可以让数据文件达到一致性(恢复的时候做的事情)。然后还需要 flush tables with read lock，把 myisam 等其他引擎的表给备份出来，备份完后解锁。这样就做到了完美的热备。


### 5、什么是基本表？什么是视图？

基本表是本身独立存在的表，在 SQL 中一个关系就对应一个表。 视图是从一个或几个基本表导出的表。视图本身不独立存储在数据库中，是一个虚表


### 6、什么是最左前缀原则？什么是最左匹配原则

**1、** 顾名思义，就是最左优先，在创建多列索引时，要根据业务需求，where子句中使用最频繁的一列放在最左边。

**2、** 最左前缀匹配原则，非常重要的原则，MySQL会一直向右匹配直到遇到范围查询(>、<、between、like)就停止匹配，比如a = 1 and b = 2 and c > 3 and d = 4 如果建立(a,b,c,d)顺序的索引，d是用不到索引的，如果建立(a,b,d,c)的索引则都可以用到，a,b,d的顺序可以任意调整。

**3、** =和in可以乱序，比如a = 1 and b = 2 and c = 3 建立(a,b,c)索引可以任意顺序，MySQL的查询优化器会帮你优化成索引可以识别的形式


### 7、如果某个表有近千万数据，CRUD比较慢，如何优化。

**分库分表**

某个表有近千万数据，可以考虑优化表结构，分表（水平分表，垂直分表），当然，你这样回答，需要准备好面试官问你的分库分表相关问题呀，如

**1、** 分表方案（水平分表，垂直分表，切分规则hash等）

**2、** 分库分表中间件（Mycat，sharding-jdbc等）

**3、** 分库分表一些问题（事务问题？跨节点Join的问题）

**4、** 解决方案（分布式事务等）

**索引优化**

除了分库分表，优化表结构，当然还有所以索引优化等方案~


### 8、如何删除索引

根据索引名删除普通索引、唯一索引、全文索引：`alter table 表名 drop KEY 索引名`

```
alter table user_index drop KEY name;
alter table user_index drop KEY id_card;
alter table user_index drop KEY information;
```

**删除主键索引：**`alter table 表名 drop primary key`（因为主键只有一个）。这里值得注意的是，如果主键自增长，那么不能直接执行此操作（自增长依赖于主键索引）：

![99_3.png][99_3.png]

**需要取消自增长再行删除：**

```
alter table user_index
-- 重新定义字段
MODIFY id int,
drop PRIMARY KEY
```

但通常不会删除主键，因为设计主键一定与业务逻辑无关。


### 9、MySQL 索引使用有哪些注意事项呢？

可以从三个维度回答这个问题：索引哪些情况会失效，索引不适合哪些场景，索引规则


### 10、SQL优化的一般步骤是什么，怎么看执行计划（explain），如何理解其中各个字段的含义。

**1、** show status 命令了解各种 sql 的执行频率

**2、** 通过慢查询日志定位那些执行效率较低的 sql 语句

**3、** explain 分析低效 sql 的执行计划（这点非常重要，日常开发中用它分析Sql，会大大降低Sql导致的线上事故）


### 11、MVCC熟悉吗，它的底层原理？
### 12、什么是锁？
### 13、MySQL有关权限的表都有哪几个
### 14、联合索引是什么？为什么需要注意联合索引中的顺序？
### 15、数据库索引的原理，为什么要用 B+树，为什么不用二叉树？
### 16、B+树在满足聚簇索引和覆盖索引的时候不需要回表查询数据，
### 17、创建索引的原则？
### 18、什么是数据库连接池?为什么需要数据库连接池呢?
### 19、优化特定类型的查询语句
### 20、简单描述MySQL中，索引，主键，唯一索引，联合索引的区别，对数据库的性能有什么影响（从读写两方面）
### 21、索引的底层实现原理和优化
### 22、使用B树的好处
### 23、什么是幻读，脏读，不可重复读呢？
### 24、创建索引的三种方式
### 25、索引有哪些优缺点？
### 26、什么是数据库连接池?为什么需要数据库连接池呢?
### 27、读写分离常见方案？
### 28、BLOB和TEXT有什么区别？
### 29、MySQL中InnoDB支持的四种事务隔离级别名称，以及逐级之间的区别？
### 30、什么是内连接、外连接、交叉连接、笛卡尔积呢？




## 全部答案，整理好了，直接下载吧

### 下载链接：[全部答案，整理好了](https://www.souyunku.com/?p=67)

### 一键直达：[https://www.souyunku.com/?p=67](https://www.souyunku.com/?p=67)


## 其他，高清PDF：172份，7701页，最新整理

[![大厂面试题](https://www.souyunku.com/wp-content/uploads/weixin/mst.png "大厂面试题")](https://souyunku.lanzous.com/b0alp9b9g "大厂面试题")

## 关注公众号：架构师专栏，回复：“面试题”，即可

[![大厂面试题](https://www.souyunku.com/wp-content/uploads/weixin/jiagoushi.png "架构师专栏")](https://souyunku.lanzous.com/b0alp9b9g "架构师专栏")

## 关注公众号：架构师专栏，回复：“面试题”，即可
