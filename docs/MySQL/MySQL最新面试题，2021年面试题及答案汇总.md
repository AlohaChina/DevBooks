# MySQL最新面试题，2021年面试题及答案汇总

### 其实，博主还整理了，更多大厂面试题，直接下载吧

### 下载链接：[高清172份，累计 7701 页大厂面试题  PDF](https://github.com/souyunku/DevBooks/blob/master/docs/index.md)



### 1、数据库的乐观锁和悲观锁是什么？怎么实现的？

数据库管理系统（DBMS）中的并发控制的任务是确保在多个事务同时存取数据库中同一数据时不破坏事务的隔离性和统一性以及数据库的统一性。乐观并发控制（乐观锁）和悲观并发控制（悲观锁）是并发控制主要采用的技术手段。

**悲观锁：**

假定会发生并发冲突，屏蔽一切可能违反数据完整性的操作。在查询完数据的时候就把事务锁起来，直到提交事务。实现方式：使用数据库中的锁机制

```
//核心SQL,主要靠for update
select status from t_goods where id=1 for update;
```

**乐观锁：**

假设不会发生并发冲突，只在提交操作时检查是否违反数据完整性。在修改数据的时候把事务锁起来，通过version的方式来进行锁定。实现方式：乐一般会使用版本号机制或CAS算法实现。

```
//核心SQL
update table set x=x+1, version=version+1 where id=#{id} and version=#{version};
```

**两种锁的使用场景**

从上面对两种锁的介绍，我们知道两种锁各有优缺点，不可认为一种好于另一种，像**乐观锁适用于写比较少的情况下（多读场景）**，即冲突真的很少发生的时候，这样可以省去了锁的开销，加大了系统的整个吞吐量。

但如果是多写的情况，一般会经常产生冲突，这就会导致上层应用会不断的进行retry，这样反倒是降低了性能，所以一般多写的场景下用悲观锁就比较合适。


### 2、关心过业务系统里面的sql耗时吗？统计过慢查询吗？对慢查询都怎么优化过？

我们平时写Sql时，都要养成用explain分析的习惯。

慢查询的统计，运维会定期统计给我们

**「优化慢查询：」**

**1、** 分析语句，是否加载了不必要的字段/数据。

**2、** 分析SQl执行句话，是否命中索引等。

**3、** 如果SQL很复杂，优化SQL结构

**4、** 如果表数据量太大，考虑分表


### 3、什么是存储过程？有哪些优缺点？

**存储过程**，就是一些编译好了的SQL语句，这些SQL语句代码像一个方法一样实现一些功能（对单表或多表的增删改查），然后给这些代码块取一个名字，在用到这个功能的时候调用即可。

**优点：**

**1、** 存储过程是一个预编译的代码块，执行效率比较高

**2、** 存储过程在服务器端运行，减少客户端的压力

**3、** 允许模块化程序设计，只需要创建一次过程，以后在程序中就可以调用该过程任意次，类似方法的复用

**4、** 一个存储过程替代大量T_SQL语句 ，可以降低网络通信量，提高通信速率

**5、** 可以一定程度上确保数据安全

**缺点：**

**1、** 调试麻烦

**2、** 可移植性不灵活

**3、** 重新编译问题


### 4、索引算法有哪些？

索引算法有 BTree算法和Hash算法

**BTree算法**

BTree是最常用的MySQL数据库索引算法，也是MySQL默认的算法。因为它不仅可以被用在=,>,>=,<,<=和between这些比较操作符上，而且还可以用于like操作符，只要它的查询条件是一个不以通配符开头的常量， 例如：

```
-- 只要它的查询条件是一个不以通配符开头的常量
select * from user where name like 'jack%'; 
-- 如果一通配符开头，或者没有使用常量，则不会使用索引，例如： 
select * from user where name like '%jack';
```

**Hash算法**

Hash Hash索引只能用于对等比较，例如=,<=>（相当于=）操作符。由于是一次定位数据，不像BTree索引需要从根节点到枝节点，最后才能访问到页节点这样多次IO访问，所以检索效率远高于BTree索引。


### 5、索引有哪几种类型？

**1、** 主键索引: 数据列不允许重复，不允许为NULL，一个表只能有一个主键。

**2、** 唯一索引: 数据列不允许重复，允许为NULL值，一个表允许多个列创建唯一索引。

**3、** 普通索引: 基本的索引类型，没有唯一性的限制，允许为NULL值。

**4、** 全文索引：是目前搜索引擎使用的一种关键技术，对文本的内容进行分词、搜索。

**5、** 覆盖索引：查询列要被所建的索引覆盖，不必读取数据行

**6、** 组合索引：多列值组成一个索引，用于组合搜索，效率大于索引合并


### 6、简单总结下

**1、** MySQL使用B+Tree作为索引数据结构。

**2、** B+Tree在新增数据时，会根据索引指定列的值对旧的B+Tree做调整。

**4、** 从物理存储结构上说，B-Tree和B+Tree都以页(4K)来划分节点的大小，但是由于B+Tree中中间节点不存储数据，因此B+Tree能够在同样大小的节点中，存储更多的key，提高查找效率。

**5、** 影响MySQL查找性能的主要还是磁盘IO次数，大部分是磁头移动到指定磁道的时间花费。

**6、** MyISAM存储引擎下索引和数据存储是分离的，InnoDB索引和数据存储在一起。

**7、** InnoDB存储引擎下索引的实现，(辅助索引)全部是依赖于主索引建立的(辅助索引中叶子结点存储的并不是数据的地址，还是主索引的值，因此，所有依赖于辅助索引的都是先根据辅助索引查到主索引，再根据主索引查数据的地址)。

**8、** 由于InnoDB索引的特性，因此如果主索引不是自增的(id作主键)，那么每次插入新的数据，都很可能对B+Tree的主索引进行重整，影响性能。因此，尽量以自增id作为InnoDB的主索引。




### 7、视图有哪些特点？哪些使用场景？

**视图特点：**

**1、** 视图的列可以来自不同的表，是表的抽象和在逻辑意义上建立的新关系。

**2、** 视图是由基本表(实表)产生的表(虚表)。

**3、** 视图的建立和删除不影响基本表。

**4、** 对视图内容的更新(添加，删除和修改)直接影响基本表。

**5、** 当视图来自多个基本表时，不允许添加和删除数据。

**视图用途：** 简化sql查询，提高开发效率，兼容老的表结构。

**视图的常见使用场景：**

**1、** 重用SQL语句；

**2、** 简化复杂的SQL操作。

**3、** 使用表的组成部分而不是整个表；

**4、** 保护数据

**5、** 更改数据格式和表示。视图可返回与底层表的表示和格式不同的数据。


### 8、为什么要使用视图？什么是视图？

**为什么要使用视图？**

为了提高复杂SQL语句的复用性和表操作的安全性，MySQL数据库管理系统提供了视图特性。

**什么是视图？**

视图是一个虚拟的表，是一个表中的数据经过某种筛选后的显示方式，视图由一个预定义的查询select语句组成。


### 9、linux添加索引

**1、** 主键索引：ALTER TABLE `table_name` ADD PRIMARY KEY ( `column` )

**2、** 唯一索引：ALTER TABLE `table_name` ADD UNIQUE ( `column` )

**3、** 普通索引：ALTER TABLE `table_name` ADD INDEX index_name ( `column` )

**4、** 全文索引：ALTER TABLE `table_name` ADD FULLTEXT ( `column`)

**5、** 多列索引：ALTER TABLE `table_name` ADD INDEX index_name ( `column1`, `column2`, `column3` )


### 10、为什么要优化

**1、** 系统的吞吐量瓶颈往往出现在数据库的访问速度上

**2、** 随着应用程序的运行，数据库的中的数据会越来越多，处理时间会相应变慢

**3、** 数据是存放在磁盘上的，读写速度无法和内存相比

优化原则：减少系统瓶颈，减少资源占用，增加系统的反应速度


### 11、什么是脏读？幻读？不可重复读？
### 12、SQL语句的语法顺序：
### 13、如何定位及优化SQL语句的性能问题？创建的索引有没有被使用到?或者说怎么才可以知道这条语句运行很慢的原因？
### 14、百万级别或以上的数据如何删除
### 15、MySQL为什么这么设计
### 16、Hash索引和B+树区别是什么？你在设计索引是怎么抉择的？
### 17、为什么官方建议使用自增长主键作为索引？
### 18、数据表损坏的修复方式有哪些？
### 19、索引的底层实现
### 20、存储时期
### 21、试述视图的优点？
### 22、索引分类？
### 23、什么是死锁？怎么解决？
### 24、你是如何监控你们的数据库的？你们的慢日志都是怎么查询的？
### 25、数据库中的事务是什么?
### 26、什么情况下设置了索引但无法使用
### 27、索引有哪些优缺点？
### 28、字段为什么要求定义为not null？
### 29、myisamchk是用来做什么的？
### 30、什么是死锁？怎么解决？




## 全部答案，整理好了，直接下载吧

### 下载链接：[全部答案，整理好了](https://www.souyunku.com/wp-content/uploads/weixin/githup-weixin-2.png)




## 最新，高清PDF：172份，7701页，最新整理

[![大厂面试题](https://www.souyunku.com/wp-content/uploads/weixin/mst.png "架构师专栏")](https://www.souyunku.com/wp-content/uploads/weixin/githup-weixin.png "架构师专栏")

[![大厂面试题](https://www.souyunku.com/wp-content/uploads/weixin/githup-weixin.png "架构师专栏")](https://www.souyunku.com/wp-content/uploads/weixin/githup-weixin.png "架构师专栏")
