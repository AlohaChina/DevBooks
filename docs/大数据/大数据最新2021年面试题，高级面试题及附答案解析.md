# 大数据最新2021年面试题，高级面试题及附答案解析

### 其实，博主还整理了，更多大厂面试题，直接下载吧

### 下载链接：[高清172份，累计 7701 页大厂面试题  PDF](https://www.souyunku.com/?p=67)

### 一键直达：[https://www.souyunku.com/?p=67](https://www.souyunku.com/?p=67)



### 1、当前日志采样格式为

a , b , c , d

b , b , f , e

a , a , c , f


### 2、HDFS读取文件的步骤

**1、** Client向NameNode请求下载某文件。

**2、** NameNode向Client返回文件的元数据。

**3、** Client向DataNode1请求访问读数据Block_1.

**4、** DataNode1向Client传输数据。

**5、** Client向DataNode2请求访问读数据Block_2.

**6、** DataNode2向Client传输数据。


### 3、hbase内部机制是什么

Hbase是一个能适应联机业务的数据库系统

物理存储：hbase的持久化数据是存放在hdfs上

存储管理：一个表是划分为很多region的，这些region分布式地存放在很多regionserver上

Region内部还可以划分为store，store内部有memstore和storefile

版本管理：hbase中的数据更新本质上是不断追加新的版本，通过compact操作来做版本间的文件合并

Region的split

集群管理：zookeeper + hmaster（职责） + hregionserver（职责）


### 4、KafkaUtils.createDstream 和 KafkaUtils.createDirectstream 区别

使用一个 receiver 接收器接收数据，接收到的数据将会保存到executor中，然后通过sparkStreaming 启动job来处理数据，默认不会丢失，可启动WAL日志，保存到hdfs上

spark.streaming.recever.writeAheadLog.enable=true 同时开启 StorageLevel.MeMORY_AND_DISK_SER_2

KafkaUtils.createDirectstream方式，他定期从Kafka的分区中查询偏移量，再根据偏移量范围在每个batch里面处理数据

优点：简化并行 高效 恰好一次被消费

hbase


### 5、什么是DAG

叫有向无环图，原始RDD通过转换形成DAG，RDD之间的依赖关系的不同划分为不同的Stage调度阶段


### 6、VM是否可以称为Pseudo？

不是，两个事物，同时Pseudo只针对Hadoop。


### 7、hbase中表的特点

大：上亿行，上百万列

无模式：每行都有一个可排序的主键和任意多的列，列可以根据需要动态增加，同一张表中不同的行可以有截然不同的列

面向列的存储和权限控制，列族独立索引

对于为null的列，并不占用存储空间，因此表可以设置的非常稀疏

数据多版本：可以有多个版本，系统自动分配，时间戳为版本号

数据类型单一：只有字节数组 byte[]

129.hbase 表逻辑结构

表有 行 和 列组成，列划分为若干个列族cloumn

表明 test

rowkey 列族1：base_info 列族2：xxx_info

0001 name:zhangsan age:20 address:bj

0002 name:lishi age:50 sex:male address:shanghai hoppies:sing

rowkey:hbase的行索引，按照rowkey字典顺序排序

cell可以锁定一个值：Rowkey+列族+列族下的列的名字+值+时间戳


### 8、RAM的溢出因子是？

溢出因子（Spill factor）是临时文件中储存文件的大小，也就是Hadoop-temp目录。


### 9、用mapreduce怎么处理数据倾斜问题

本质：让各分区的数据分布均匀

可以根据业务特点，设置合适的partition策略

如果事先根本不知道数据的分布规律，利用随机抽样器抽样后生成partition策略再处理


### 10、hbase如何调优

**1、** 垃圾回收调优

**2、** 优化region拆分合并以及拆分region

**3、** 客户端入库调优

**4、** Hbase配置文件


### 11、Hadoop是否遵循UNIX模式？
### 12、简要描述如何安装配置apache的一个开源hadoop，只描述即可，无需列出具体步骤，列出具体步骤更好。
### 13、MapReduce优化经验
### 14、对于hadoop自带的wordcount的例子，value就是一个叠加的数字，所以map一结束就可以进行reduce的value叠加，而不必要等到所有的map结束再去进行reduce的value叠加。
### 15、请你用最熟悉的语言编写mapreduce，计算第四列每个元素出现的个数
### 16、请列出正常工作的hadoop集群中hadoop都需要启动哪些进程，他们的作用分别是什么？
### 17、请列出你在工作中使用过的开发mapreduce的语言
### 18、HDFS存储机制
### 19、Hbase宕机如何处理
### 20、mapreduce的原理
### 21、请描述一下开发过程中如何对上面的程序进行性能分析，对性能分析进行优化的过程。
### 22、RDD 是什么
### 23、请用java实现非递归二分查询
### 24、hive底层与数据库交互原理
### 25、Slaves由什么组成？
### 26、现场出问题测试mapreduce掌握情况和hive的ql语言掌握情况
### 27、怎么保证Kafka集群的负载均衡？
### 28、MR程序运行的时候会有什么比较常见的问题？
### 29、请列出正常的hadoop集群中hadoop都分别需要启动 哪些进程，他们的作用分别都是什么，请尽量列的详细一些。
### 30、3个datanode中有一个datanode出现错误会怎样？
### 31、Hadoop的shuffle过程
### 32、海量日志数据，提取出某日访问百度次数最多的那个IP。
### 33、hadoop的TextInputFormat作用是什么，如何自定义实现？




## 全部答案，整理好了，直接下载吧

### 下载链接：[全部答案，整理好了](https://www.souyunku.com/?p=67)

### 一键直达：[https://www.souyunku.com/?p=67](https://www.souyunku.com/?p=67)


## 最新，高清PDF：172份，7701页，最新整理

[![大厂面试题](https://www.souyunku.com/wp-content/uploads/weixin/mst.png "架构师专栏")](https://www.souyunku.com/wp-content/uploads/weixin/githup-weixin.png "架构师专栏")

[![大厂面试题](https://www.souyunku.com/wp-content/uploads/weixin/githup-weixin.png "架构师专栏")](https://www.souyunku.com/wp-content/uploads/weixin/githup-weixin.png "架构师专栏")
