# Kafka最新2021年面试题大汇总，附答案

### 其实，博主还整理了，更多大厂面试题，直接下载吧

### 下载链接：[高清172份，累计 7701 页大厂面试题  PDF](https://www.souyunku.com/?p=67)

### 一键直达：[https://www.souyunku.com/?p=67](https://www.souyunku.com/?p=67)



### 1、：31, 32, 33, 34, 38, 39, 40Apache Kafka对于有经验的人的面试
### 2、讲讲Kafka维护消费状态跟踪的方法

**1、** 大部分消息系统在broker端的维护消息被消费的记录：一个消息被分发到consumer后broker就马上进行标记或者等待customer的通知后进行标记。这样也可以在消息在消费后立马就删除以减少空间占用。

**2、** 但是这样会不会有什么问题呢？如果一条消息发送出去之后就立即被标记为消费过的，一旦consumer处理消息时失败了（比如程序崩溃）消息就丢失了。为了解决这个问题，很多消息系统提供了另外一个个功能：当消息被发送出去之后仅仅被标记为已发送状态，当接到consumer已经消费成功的通知后才标记为已被消费的状态。这虽然解决了消息丢失的问题，但产生了新问题，首先如果consumer处理消息成功了但是向broker发送响应时失败了，这条消息将被消费两次。第二个问题时，broker必须维护每条消息的状态，并且每次都要先锁住消息然后更改状态然后释放锁。这样麻烦又来了，且不说要维护大量的状态数据，比如如果消息发送出去但没有收到消费成功的通知，这条消息将一直处于被锁定的状态，

**3、** Kafka采用了不同的策略。Topic被分成了若干分区，每个分区在同一时间只被一个consumer消费。这意味着每个分区被消费的消息在日志中的位置仅仅是一个简单的整数：offset。这样就很容易标记每个分区消费状态就很容易了，仅仅需要一个整数而已。这样消费状态的跟踪就很简单了。

**4、** 这带来了另外一个好处：consumer可以把offset调成一个较老的值，去重新消费老的消息。这对传统的消息系统来说看起来有些不可思议，但确实是非常有用的，谁规定了一条消息只能被消费一次呢？


### 3、Kafka的message格式是什么？

一个Kafka的Message由一个**固定长度的header**和一个**变长的消息体body**组成

1. header部分 由一个字节的magic(文件格式)和四个字节的CRC32(用于判断body消息体是否正常)构成。
2. 当magic的值为1的时候，会在magic和crc32之间多一个字节的数据：attributes(保存一些相关属性，比如是否压缩、压缩格式等等);
3. 如果magic的值为0，那么不存在attributes属性
4. body部分 由N个字节构成的一个消息体，包含了具体的key/value消息


### 4、Kafka判断一个节点是否还活着有那两个条件？

**1、** 节点必须可以维护和ZooKeeper的连接，Zookeeper通过心跳机制检查每个节点的连接

**2、** 如果节点是个follower,他必须能及时的同步leader的写操作，延时不能太久


### 5、消费者提交消费位移时提交的是当前消费到的最新消息的offset还是offset+1?

offset+1


### 6、Kafka 的设计时什么样的呢？

**1、** Kafka 将消息以 topic 为单位进行归纳

**2、** 将向 Kafka topic 发布消息的程序成为 producers.

**3、** 将预订 topics 并消费消息的程序成为 consumer.

**4、** Kafka 以集群的方式运行，可以由一个或多个服务组成，每个服务叫做一个 broker.

**5、** producers 通过网络将消息发送到 Kafka 集群，集群向消费者提供消息


### 7、如果 Leader Crash 时，ISR为空怎么办

Kafka在Broker端提供了一个配置参数：unclean.leader.election,这个参数有两个值：

**true**（默认）：允许不同步副本成为leader，由于不同步副本的消息较为滞后，此时成为leader，可能会出现消息不一致的情况。

**false**：不允许不同步副本成为leader，此时如果发生ISR列表为空，会一直等待旧leader恢复，降低了可用性。


### 8、：3,5,6


### 9、副本和ISR扮演什么角色？

基本上，复制日志的节点列表就是副本。特别是对于特定的分区。但是，无论他们是否扮演领导者的角色，他们都是如此。此外，ISR指的是同步副本。在定义ISR时，它是一组与领导者同步的消息副本。


### 10、数据传输的事物定义有哪三种？

**数据传输的事务定义通常有以下三种级别：**

**1、** 最多一次: 消息不会被重复发送，最多被传输一次，但也有可能一次不传输

**2、** 最少一次: 消息不会被漏发送，最少被传输一次，但也有可能被重复传输、（3）精确的一次（Exactly once）: 不会漏传输也不会重复传输,每个消息都传输被一次而

**3、** 且仅仅被传输一次，这是大家所期望的


### 11、当ack为-1时，什么情况下，Leader 认为一条消息 Commit了？
### 12、：41, 42, 43, 44, 45, 47, 49Apache Kafka对于有经验的人的面试
### 13、解释术语“主题复制因子”。
### 14、解释Kafka可以接收的消息最大为多少？
### 15、LEO、LSO、AR、ISR、HW都表示什么含义？
### 16、为什么要使用Apache Kafka集群？
### 17、Kafka Producer如何优化写入速度?
### 18、传统的消息传递方法有哪些类型？
### 19、在生产者中，何时发生QueueFullException？
### 20、系统工具有哪些类型？
### 21、Kafka和Flume之间的主要区别是什么？
### 22、监控Kafka的框架都有哪些？
### 23、说明Kafka的一个最佳特征。
### 24、为什么Kafka的复制至关重要？
### 25、什么是生产者？
### 26、Kafka中的数据日志是什么？
### 27、Kafka中有哪几个组件?
### 28、什么是消费者或用户？




## 全部答案，整理好了，直接下载吧

### 下载链接：[全部答案，整理好了](https://www.souyunku.com/?p=67)

### 一键直达：[https://www.souyunku.com/?p=67](https://www.souyunku.com/?p=67)


## 最新，高清PDF：172份，7701页，最新整理

[![大厂面试题](https://www.souyunku.com/wp-content/uploads/weixin/mst.png "架构师专栏")](https://www.souyunku.com/wp-content/uploads/weixin/githup-weixin.png "架构师专栏")

[![大厂面试题](https://www.souyunku.com/wp-content/uploads/weixin/githup-weixin.png "架构师专栏")](https://www.souyunku.com/wp-content/uploads/weixin/githup-weixin.png "架构师专栏")
