# 并发编程高级面试题及答案，2021版

### 其实，博主还整理了，更多大厂面试题，直接下载吧

### 下载链接：[高清172份，累计 7701 页大厂面试题  PDF](https://github.com/souyunku/DevBooks/blob/master/docs/index.md)



### 1、什么是自旋

很多synchronized里面的代码只是一些很简单的代码，执行时间非常快，此时等待的线程都加锁可能是一种不太值得的操作，因为线程阻塞涉及到用户态和内核态切换的问题。既然synchronized里面的代码执行得非常快，不妨让等待锁的线程不要被阻塞，而是在synchronized的边界做忙循环，这就是自旋。如果做了多次忙循环发现还没有获得锁，再阻塞，这样可能是一种更好的策略。


### 2、JVM 内存区域

JVM 内存区域主要分为线程私有区域【程序计数器、虚拟机栈、本地方法区】、线程共享区域【JAVA 堆、方法区】、直接内存。

线程私有数据区域生命周期与线程相同, 依赖用户线程的启动/结束 而 创建/销毁(在 Hotspot VM 内, 每个线程都与操作系统的本地线程直接映射, 因此这部分内存区域的存/否跟随本地线程的生/死对应)。

线程共享区域随虚拟机的启动/关闭而创建/销毁。

直接内存并不是 JVM 运行时数据区的一部分, 但也会被频繁的使用: 在 JDK 1.4 引入的 NIO 提供了基于Channel与 Buffer的IO方式, 它可以使用Native函数库直接分配堆外内存, 然后使用DirectByteBuffer 对象作为这块内存的引用进行操作(详见: Java I/O 扩展), 这样就避免了在 Java堆和 Native 堆中来回复制数据, 因此在一些场景中可以显著提高性能。


### 3、什么是堆

存放对象实例，所有的对象和数组都要在堆上分配。 是 JVM 所管理的内存中最大的一块区域。


### 4、Java 中的同步集合与并发集合有什么区别？

同步集合与并发集合都为多线程和并发提供了合适的线程安全的集合，不过并发集合的可扩展性更高。在 Java1.5 之前程序员们只有同步集合来用且在多线程并发的时候会导致争用，阻碍了系统的扩展性。Java5 介绍了并发集合像ConcurrentHashMap，不仅提供线程安全还用锁分离和内部分区等现代技术提高了可扩展性。


### 5、什么是FutureTask?使用ExecutorService启动任务。

在Java并发程序中FutureTask表示一个可以取消的异步运算。它有启动和取消运算、查询运算是否完成和取回运算结果等方法。只有当运算完成的时候结果才能取回，如果运算尚未完成get方法将会阻塞。一个FutureTask对象可以对调用了Callable和Runnable的对象进行包装，由于FutureTask也是调用了Runnable接口所以它可以提交给Executor来执行。


### 6、什么是逃逸分析？

**分析对象动态作用域**

**1、** 当一个对象在方法里面被定义后，它可能被外部方法所引用，例如作为调用参数传递到其他方法中，这种称为方法逃逸；

**2、** 被外部线程访问到，譬如赋值给可以在其他线程中访问的实例变量，这种称为线程逃逸；

**3、** 从不逃逸

**4、** 如果能证明一个对象不会逃逸到方法或线程之外，或者逃逸程度比较低（只逃逸出方法而不会逃逸出线程），则可能为这个对象实例采取不同程度的优化，如栈上分配、标量替换、同步消除。


### 7、工作中常用的 JVM 配置参数有哪些？

Java 8 为例

**日志**

**1、** -XX:+PrintFlagsFinal，打印JVM所有参数的值

**2、** -XX:+PrintGC，打印GC信息

**3、** -XX:+PrintGCDetails，打印GC详细信息

**4、** -XX:+PrintGCTimeStamps，打印GC的时间戳

**5、** -Xloggc:filename，设置GC log文件的位置

**6、** -XX:+PrintTenuringDistribution，查看熬过收集后剩余对象的年龄分布信息

**内存设置**

**1、** -Xms，设置堆的初始化内存大小

**2、** -Xmx，设置堆的最大内存

**3、** -Xmn，设置新生代内存大小

**4、** -Xss，设置线程栈大小

**5、** -XX:NewRatio，新生代与老年代比值

**6、** -XX:SurvivorRatio，新生代中Eden区与两个Survivor区的比值，默认为8，即Eden:Survivor:Survivor=8:1:1

**7、** -XX:MaxTenuringThreshold，从年轻代到老年代，最大晋升年龄。CMS 下默认为 6，G1 下默认为 15

**8、** -XX:MetaspaceSize，设置元空间的大小，第一次超过将触发 GC

**9、** -XX:MaxMetaspaceSize，元空间最大值

**10、** -XX:MaxDirectMemorySize，用于设置直接内存的最大值，限制通过 DirectByteBuffer 申请的内存

**11、** -XX:ReservedCodeCacheSize，用于设置 JIT 编译后的代码存放区大小，如果观察到这个值有限制，可以适当调大，一般够用即可

**设置垃圾收集相关**

**1、** -XX:+UseSerialGC，设置串行收集器

**2、** -XX:+UseParallelGC，设置并行收集器

**3、** -XX:+UseConcMarkSweepGC，使用CMS收集器

**4、** -XX:ParallelGCThreads，设置Parallel GC的线程数

**5、** -XX:MaxGCPauseMillis，GC最大暂停时间 ms

**6、** -XX:+UseG1GC，使用G1垃圾收集器

**CMS 垃圾回收器相关**

**1、** -XX:+UseCMSInitiatingOccupancyOnly

**2、** -XX:CMSInitiatingOccupancyFraction，与前者配合使用，指定MajorGC的发生时机

**3、** -XX:+ExplicitGCInvokesConcurrent，代码调用 System.gc() 开始并行 FullGC，建议加上这个参数

**4、** -XX:+CMSScavengeBeforeRemark，表示开启或关闭在 CMS 重新标记阶段之前的清除（YGC）尝试，它可以降低 remark 时间，建议加上

**5、** -XX:+ParallelRefProcEnabled，可以用来并行处理 Reference，以加快处理速度，缩短耗时

**G1 垃圾回收器相关**

**1、** -XX:MaxGCPauseMillis，用于设置目标停顿时间，G1 会尽力达成

**2、** -XX:G1HeapRegionSize，用于设置小堆区大小，建议保持默认

**3、** -XX:InitiatingHeapOccupancyPercent，表示当整个堆内存使用达到一定比例（默认是 45%），并发标记阶段就会被启动

**4、** -XX:ConcGCThreads，表示并发垃圾收集器使用的线程数量，默认值随 JVM 运行的平台不同而变动，不建议修改

参数查询官网地址：

[https://docs.oracle.com/javase/8/docs/technotes/tools/unix/java.html](https://docs.oracle.com/javase/8/docs/technotes/tools/unix/java.html)

建议面试时最好能记住 CMS 和 G1的参数，特点突出使用较多，被问的概率大


### 8、对象在哪块内存分配？
### 9、死锁的原因
### 10、什么是方法区
### 11、说一下堆和栈的区别
### 12、怎么判断并发队列是阻塞队列还是非阻塞队列
### 13、用过ConcurrentHashMap，讲一下他和HashTable的不同之处？
### 14、JVM垃圾回收机制，何时触发MinorGC等操作
### 15、同步方法和同步块，哪个是更好的选择？
### 16、finalize()方法什么时候被调用？析构函数(finalization)的目的是什么？
### 17、什么叫线程安全？servlet 是线程安全吗?
### 18、SynchronizedMap和ConcurrentHashMap有什么区别？
### 19、方法区溢出的原因？
### 20、谈谈永久代
### 21、newScheduledThreadPool
### 22、SynchronizedMap 和 ConcurrentHashMap 有什么区别？
### 23、Java的内存模型是什么？（JMM是什么？）
### 24、各种回收器，各自优缺点，重点CMS、G1
### 25、ReadWriteLock是什么
### 26、生产环境用的什么JDK？如何配置的垃圾收集器？
### 27、重排序遵守的规则
### 28、什么是乐观锁和悲观锁
### 29、虚拟机栈(线程私有)
### 30、什么是CPU密集
### 31、JVM垃圾回收时候如何确定垃圾？什么是GC Roots？




## 全部答案，整理好了，直接下载吧

### 下载链接：[全部答案，整理好了](https://www.souyunku.com/wp-content/uploads/weixin/githup-weixin-2.png)




## 最新，高清PDF：172份，7701页，最新整理

[![大厂面试题](https://www.souyunku.com/wp-content/uploads/weixin/mst.png "架构师专栏")](https://www.souyunku.com/wp-content/uploads/weixin/githup-weixin.png "架构师专栏")

[![大厂面试题](https://www.souyunku.com/wp-content/uploads/weixin/githup-weixin.png "架构师专栏")](https://www.souyunku.com/wp-content/uploads/weixin/githup-weixin.png "架构师专栏")
