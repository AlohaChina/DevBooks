# 并发编程最新面试题，常见面试题及答案汇总

### 其实，博主还整理了，更多大厂面试题，直接下载吧

### 下载链接：[高清172份，累计 7701 页大厂面试题  PDF](https://www.souyunku.com/?p=67)

### 一键直达：[https://www.souyunku.com/?p=67](https://www.souyunku.com/?p=67)



### 1、强引用、软引用、弱引用、虚引用是什么？

**普通的对象引用关系就是强引用**

软引用用于维护一些可有可无的对象。只有在内存不足时，系统则会回收软引用对象，如果回收了软引用对象之后仍然没有足够的内存，才会抛出内存溢出异常。

弱引用对象相比较软引用，要更加无用`一些`，它拥有更短的生命周期。当JVM进行垃圾回收时，无论内存是否充足，都会回收被弱引用关联的对象。

虚引用是一种形同虚设的引用，在现实场景中用的不是很多，它主要用来跟踪对象被垃圾回收的活动。


### 2、说一下 synchronized 底层实现原理？

**1、** Synchronized的语义底层是通过一个monitor（监视器锁）的对象来完成，

**2、** 每个对象有一个监视器锁(monitor)。每个Synchronized修饰过的代码当它的monitor被占用时就会处于锁定状态并且尝试获取monitor的所有权 ，过程：

**1、** 如果monitor的进入数为0，则该线程进入monitor，然后将进入数设置为1，该线程即为monitor的所有者。

**2、** 如果线程已经占有该monitor，只是重新进入，则进入monitor的进入数加1.

**3、** 如果其他线程已经占用了monitor，则该线程进入阻塞状态，直到monitor的进入数为0，再重新尝试获取monitor的所有权。

synchronized是可以通过 反汇编指令 javap命令，查看相应的字节码文件。


### 3、Semaphore有什么作用

Semaphore就是一个信号量，它的作用是限制某段代码块的并发数。Semaphore有一个构造函数，可以传入一个int型整数n，表示某段代码最多只有n个线程可以访问，如果超出了n，那么请等待，等到某个线程执行完毕这段代码块，下一个线程再进入。由此可以看出如果Semaphore构造函数中传入的int型整数n=1，相当于变成了一个synchronized了。


### 4、synchronized、volatile、CAS比较

**1、** synchronized是悲观锁，属于抢占式，会引起其他线程阻塞。

**2、** volatile提供多线程共享变量可见性和禁止指令重排序优化。

**3、** CAS是基于冲突检测的乐观锁（非阻塞）


### 5、CAS的问题

**1、** CAS容易造成ABA问题

一个线程a将数值改成了b，接着又改成了a，此时CAS认为是没有变化，其实是已经变化过了，而这个问题的解决方案可以使用版本号标识，每操作一次version加1。在java5中，已经提供了AtomicStampedReference来解决问题。

**2、** 不能保证代码块的原子性

CAS机制所保证的知识一个变量的原子性操作，而不能保证整个代码块的原子性。比如需要保证3个变量共同进行原子性的更新，就不得不使用synchronized了。

**3、** CAS造成CPU利用率增加

之前说过了CAS里面是一个循环判断的过程，如果线程一直没有获取到状态，cpu资源会一直被占用。


### 6、可以描述一下 class 文件的结构吗？

**1、** Class 文件包含了 Java 虚拟机的指令集、符号表、辅助信息的字节码(Byte Code)，是实现跨操作系统和语言无关性的基石之一。

**2、** 一个 Class 文件定义了一个类或接口的信息，是以 8 个字节为单位，没有分隔符，按顺序紧凑排在一起的二进制流。

**3、** 用 "无符号数" 和 "表" 组成的伪结构来存储数据。

**4、** 无符号数：基本数据类型，用来描述数字、索引引用、数量值、字符串值，如u1、u2 分别表示 1 个字节、2 个字节

**10、** 表：无符号数和其他表组成，命名一般以 "_info" 结尾

**组成部分**

**1、** 魔数 Magic Number

Class 文件头 4 个字节，0xCAFEBABE

作用是确定该文件是 Class 文件

**2、** 版本号

4 个字节，前 2 个是次版本号 Minor Version，后 2 个主版本号 Major Version

从 45 (JDK1.0) 开始，如 0x00000032 转十进制就是 50，代表 JDK 6

低版本的虚拟机跑不了高版本的 Class 文件

**3、** 常量池

常量容量计数值(constant_pool_count)，u2，从 1 开始。如 0x0016 十进制 22 代表有

21 项常量

每项常量都是一个表，目前 17 种

特点：Class 文件中最大数据项目之一、第一个出现表数据结构

**4、** 访问标志

2 个字节，表示类或接口的访问标志

**5、** 类索引、父类索引、接口索引集合

类索引(this_class)、父类索引(super_class)，u2

接口索引集合(interfaces)，u2 集合

类索引确定类的全限定名、父类索引确定父类的全限定名、接口索引集合确定实现接口

索引值在常量池中查找对应的常量

**6、** 字段表(field_info)集合

描述接口或类申明的变量

fields_count，u2，表示字段表数量；后面接着相应数量的字段表

9 种字段访问标志

**7、** 方法表(method_info)集合

**描述接口或类申明的方法**

methods_count，u2，表示方法表数量；后面接着相应数量的方法表

12 种方法访问标志

**方法表结构与字段表结构一致**

**8、** 属性表(attribute_info)集合

class 文件、字段表、方法表可携带属性集合，描述特有信息

预定义 29 项属性，可自定义写入不重名属性


### 7、在新生代-复制算法

每次垃圾收集都能发现大批对象已死, 只有少量存活、因此选用复制算法, 只需要付出少量存活对象的复制成本就可以完成收集


### 8、如何写一段简单的死锁代码？

这个笔试的话频率也挺高（遇见笔试的公司要三思啊），所以这里直接给出一个答案（有很多版本的）。

```
public class DeadLockDemo {
    public static void main(String[] args) {
        Object object1 = new Object();
        Object object2 = new Object();
        Thread t1 = new Thread(() -> {
            synchronized (object1) {
                try {
                    Thread.sleep(200);
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
                synchronized (object2) {
                }
            }
        }, "deadlock-demo-1");

        t1.start();
        Thread t2 = new Thread(() -> {
            synchronized (object2) {
                synchronized (object1) {
                }
            }
        }, "deadlock-demo-2");
        t2.start();
    }
}
```


### 9、Java中的同步集合与并发集合有什么区别？

同步集合与并发集合都为多线程和并发提供了合适的线程安全的集合，不过并发集合的可扩展性更高。在Java1.5之前程序员们只有同步集合来用且在多线程并发的时候会导致争用，阻碍了系统的扩展性。Java5介绍了并发集合像ConcurrentHashMap，不仅提供线程安全还用锁分离和内部分区等现代技术提高了可扩展性。


### 10、工作中常用的 JVM 配置参数有哪些？

Java 8 为例

**日志**

**1、** -XX:+PrintFlagsFinal，打印JVM所有参数的值

**2、** -XX:+PrintGC，打印GC信息

**3、** -XX:+PrintGCDetails，打印GC详细信息

**4、** -XX:+PrintGCTimeStamps，打印GC的时间戳

**5、** -Xloggc:filename，设置GC log文件的位置

**6、** -XX:+PrintTenuringDistribution，查看熬过收集后剩余对象的年龄分布信息

**内存设置**

**1、** -Xms，设置堆的初始化内存大小

**2、** -Xmx，设置堆的最大内存

**3、** -Xmn，设置新生代内存大小

**4、** -Xss，设置线程栈大小

**5、** -XX:NewRatio，新生代与老年代比值

**6、** -XX:SurvivorRatio，新生代中Eden区与两个Survivor区的比值，默认为8，即Eden:Survivor:Survivor=8:1:1

**7、** -XX:MaxTenuringThreshold，从年轻代到老年代，最大晋升年龄。CMS 下默认为 6，G1 下默认为 15

**8、** -XX:MetaspaceSize，设置元空间的大小，第一次超过将触发 GC

**9、** -XX:MaxMetaspaceSize，元空间最大值

**10、** -XX:MaxDirectMemorySize，用于设置直接内存的最大值，限制通过 DirectByteBuffer 申请的内存

**11、** -XX:ReservedCodeCacheSize，用于设置 JIT 编译后的代码存放区大小，如果观察到这个值有限制，可以适当调大，一般够用即可

**设置垃圾收集相关**

**1、** -XX:+UseSerialGC，设置串行收集器

**2、** -XX:+UseParallelGC，设置并行收集器

**3、** -XX:+UseConcMarkSweepGC，使用CMS收集器

**4、** -XX:ParallelGCThreads，设置Parallel GC的线程数

**5、** -XX:MaxGCPauseMillis，GC最大暂停时间 ms

**6、** -XX:+UseG1GC，使用G1垃圾收集器

**CMS 垃圾回收器相关**

**1、** -XX:+UseCMSInitiatingOccupancyOnly

**2、** -XX:CMSInitiatingOccupancyFraction，与前者配合使用，指定MajorGC的发生时机

**3、** -XX:+ExplicitGCInvokesConcurrent，代码调用 System.gc() 开始并行 FullGC，建议加上这个参数

**4、** -XX:+CMSScavengeBeforeRemark，表示开启或关闭在 CMS 重新标记阶段之前的清除（YGC）尝试，它可以降低 remark 时间，建议加上

**5、** -XX:+ParallelRefProcEnabled，可以用来并行处理 Reference，以加快处理速度，缩短耗时

**G1 垃圾回收器相关**

**1、** -XX:MaxGCPauseMillis，用于设置目标停顿时间，G1 会尽力达成

**2、** -XX:G1HeapRegionSize，用于设置小堆区大小，建议保持默认

**3、** -XX:InitiatingHeapOccupancyPercent，表示当整个堆内存使用达到一定比例（默认是 45%），并发标记阶段就会被启动

**4、** -XX:ConcGCThreads，表示并发垃圾收集器使用的线程数量，默认值随 JVM 运行的平台不同而变动，不建议修改

参数查询官网地址：

[https://docs.oracle.com/javase/8/docs/technotes/tools/unix/java.html](https://docs.oracle.com/javase/8/docs/technotes/tools/unix/java.html)

建议面试时最好能记住 CMS 和 G1的参数，特点突出使用较多，被问的概率大


### 11、什么是线程池？ 为什么要使用它？
### 12、并行和并发有什么区别？
### 13、本地方法栈的作用？
### 14、JRE、JDK、JVM 及 JIT 之间有什么不同？
### 15、什么是多线程
### 16、对象的内存布局了解吗？
### 17、类加载是什么？
### 18、64 位 JVM 中，int 的长度是多数？
### 19、如何判断两个类是否相等？
### 20、什么是ThreadLocal变量？
### 21、OSGI（ 动态模型系统）
### 22、什么是原子操作？在Java Concurrency API中有哪些原子类(atomic classes)？
### 23、为什么需要双亲委派模式？
### 24、sleep方法和wait方法有什么区别?
### 25、JVM 中一次完整的 GC 流程（从 ygc 到 fgc）是怎样的
### 26、Java中interrupted 和 isInterrupted方法的区别？
### 27、什么是多线程中的上下文切换？
### 28、说一下堆内存中对象的分配的基本策略
### 29、请说出与线程同步以及线程调度相关的方法。
### 30、什么是IO密集
### 31、Java 中堆和栈有什么区别？
### 32、什么是线程组，为什么在 Java 中不推荐使用？




## 全部答案，整理好了，直接下载吧

### 下载链接：[全部答案，整理好了](https://www.souyunku.com/?p=67)

### 一键直达：[https://www.souyunku.com/?p=67](https://www.souyunku.com/?p=67)


## 最新，高清PDF：172份，7701页，最新整理

[![大厂面试题](https://www.souyunku.com/wp-content/uploads/weixin/mst.png "架构师专栏")](https://www.souyunku.com/wp-content/uploads/weixin/githup-weixin.png "架构师专栏")

[![大厂面试题](https://www.souyunku.com/wp-content/uploads/weixin/githup-weixin.png "架构师专栏")](https://www.souyunku.com/wp-content/uploads/weixin/githup-weixin.png "架构师专栏")
